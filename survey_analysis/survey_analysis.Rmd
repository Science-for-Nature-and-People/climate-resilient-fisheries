---
title: "Survey-Response-Analysis"
author: "Robert Saldivar"
date: "9/18/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This document will be used to analyze survey responses

```{r}
#Loading the nessecary packages
library(tidyverse)
library(googlesheets4)
library(here)
library(janitor)

#for text mining open responses
library(tidytext)
library(textdata)
library(ggwordcloud)


```

```{r}

#gs4_auth() # Run this in console with your email address. It allow R to access your google sheets

```

```{r}
Test_section0 <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1vcWRmro97z5HXzoKhaAK4nrhFJwghCI2oCLEAeHnwD4/edit?usp=drive_web", 
                           sheet = "0_YourName",
                           range = "A4:C5",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

test_section1 <-read_sheet(ss = "https://docs.google.com/spreadsheets/d/1vcWRmro97z5HXzoKhaAK4nrhFJwghCI2oCLEAeHnwD4/edit?usp=drive_web", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() #%>%
  #remove_empty(which = c("rows", "cols")) #not sure if the remove will be best when analyzing multiple sheets

test_section2 <- read_sheet(ss ="https://docs.google.com/spreadsheets/d/1vcWRmro97z5HXzoKhaAK4nrhFJwghCI2oCLEAeHnwD4/edit?usp=drive_web", 
                           sheet = "S2_ContextualDescription",
                           range = "A9:U91",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

test_section3 <- read_sheet(ss ="https://docs.google.com/spreadsheets/d/1vcWRmro97z5HXzoKhaAK4nrhFJwghCI2oCLEAeHnwD4/edit?usp=drive_web", 
                           sheet = "S3_ClimateResilientActions",
                           range = "A9:H29",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

test_section4 <- read_sheet(ss ="https://docs.google.com/spreadsheets/d/1vcWRmro97z5HXzoKhaAK4nrhFJwghCI2oCLEAeHnwD4/edit?usp=drive_web", 
                           sheet = "S4_ResilienceAttributes",
                           range = "A9:M61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

test_section5 <- read_sheet(ss ="https://docs.google.com/spreadsheets/d/1vcWRmro97z5HXzoKhaAK4nrhFJwghCI2oCLEAeHnwD4/edit?usp=drive_web", 
                           sheet = "S5_CapacitytoImproveClimate",
                           range = "A9:H15",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

```

This will be for testing analysis
```{r}
test_analysis1 <- read_sheet(ss ="https://docs.google.com/spreadsheets/d/1D-ktJpRK8qHCU1HtcyiUZVP6G6fhSE4Pfm5W12KMYB8/edit?usp=sharing", 
                           sheet = "S4_ResilienceAttributes",
                           range = "A9:M61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

test_analysis2 <- read_sheet(ss ="https://docs.google.com/spreadsheets/d/16WgYKtJSccJ9Fk0qOmD-CuCRO8NH1DBYfes6Fcdlkn8/edit?usp=sharing", 
                           sheet = "S4_ResilienceAttributes",
                           range = "A9:M61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

test_section4_bind <- bind_rows(test_analysis1, test_analysis2, test_section4)

test_section4_bind_filter1 <- test_section4_bind %>%
  filter(question_id == "4.1.1.1")

s4q1_count <- count(test_section4_bind_filter1, test_section4_bind_filter1$score_1_4)

s4_data_quality_count <- count(test_section4_bind, test_section4_bind$information_quality)

s4_mechanism <- count(test_section4_bind, test_section4_bind$does_the_mechanism_work_as_described_in_your_system)

s4_data_quality_plot <- ggplot(test_section4_bind, aes(x = information_quality)) +
  geom_bar()

s4q1_count
s4_data_quality_count
s4_mechanism
s4_data_quality_plot



```

################################################################################################################################################
Section 1 Analysis

```{r, include=FALSE}
#This will read in all of the data for section 1

respondant1_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant2_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant3_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant4_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant5_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant6_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant7_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant8_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant9_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant10_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant11_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant12_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant13_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant14_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant15_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant16_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant17_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant18_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant19_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant20_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant21_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant22_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant23_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant24_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

respondant25_s1 <-read_sheet(ss = "", 
                           sheet = "S1_KeyCaseIdentifiers",
                           range = "A9:P18",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()

s1_bind <- bind_rows(respondant1_s1, respondant2_s1, respondant3_s1, respondant4_s1, respondant5_s1, respondant6_s1, respondant7_s1, respondant8_s1, respondant9_s1, respondant10_s1, respondant11_s1, respondant12_s1, respondant13_s1, respondant14_s1, respondant15_s1, respondant16_s1, respondant17_s1, respondant18_s1, respondant19_s1, respondant20_s1, respondant21_s1, respondant22_s1, respondant23_s1, respondant24_s1, respondant25_s1)

```



################################################################################################################################################
Section 2 Analysis



################################################################################################################################################
Section 3 Analysis



################################################################################################################################################
Section 4 Analysis



################################################################################################################################################
Section 5 Analysis


---
title: "Resilience Atttribute Case by Case Comparison"
author: "Meghan Fletcher"
date: "11/29/2021"
output: 
  html_document:
    theme: flatly
    code_folding: hide
    toc: true
    toc_float: true
---

```{r setup, include=FALSE, message = FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

#Load libraries
library(ggplot2)
library(tidyverse)
library(janitor)
library(googlesheets4)
library(here)
library(kableExtra)
```

# Read in the data from Google Sheets
```{r, results=FALSE, message = FALSE, warning = FALSE, class.source = 'fold-hide', warning = FALSE}
aguion_barnacle <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1WfGsKOT0gFSN1yHUObDNSQflqd5avodSuf3kOZLTyLk/edit#gid=1947230832", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Aguion",
             reference = "aguion1",
             .after = "question_id")



#######################################################################################################################
burden_sardine <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1TkB-P94xgRssmcbAuzwoh0BlDdvUfYHO7vWjK6r2pxs/edit#gid=1965519914", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names()%>% 
  add_column(case_study = "Burden",
             reference = "burden1",
             .after = "question_id")



#######################################################################################################################
dickey_collas_eur <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1hfXTM5hwe0iLWQQmrc31-xruOV3SUixuxqRSuqC8ydA/edit#gid=1707192308", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Dickey_Collas",
             reference = "dickey_collas1",
             .after = "question_id")



#######################################################################################################################
eurich_clam <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1ZEIev1lcoD6Lxu3otzDCfbJJSiPJoZeyYbTvBXb_S9U/edit#gid=1453404713", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Eurich",
             reference = "eurich1",
             .after = "question_id")



#####################################################################################################################################
free_crab <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/12zMb5el0QAB-CdZdmdKjWw5Krbwx7farqlUvbN08HEg/edit#gid=390317686", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Free",
             reference = "free1",
             .after = "question_id")



#######################################################################################################################
golden_madagascar <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1w99nN8C_Vd82j4Y23g2ZG_kuEh_Jc2HkW6lnLkhzeCU/edit#gid=1980661832", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Golden",
             reference = "golden1",
             .after = "question_id")



#######################################################################################################################
friedman_fiji <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/13fgkP1xHZB6gZqXUBHuylaC3ImCDIDTFFjqQ8RAoV-s/edit#gid=476628697", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Friedman",
             reference = "friedman1",
             .after = "question_id")



#######################################################################################################################
hollowed_bering_sea <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1YOYZ9T7RR_8OkqQIWeZobhS-3yaEbKmuAVz16Nrrz9g/edit#gid=1980661832", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Hollowed",
             reference = "hollowed1",
             .after = "question_id")



########################################################################################################################
kisara_squid <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1RX1iUmEKsOUmuPZkn4SMA6zts9TTPz-gi0D6XFrY1RQ/edit#gid=934077877", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Kisara",
             reference = "kisara1",
             .after = "question_id") 



###########################################################################################################################
kleisner_jfi <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1YM1wc6F0SgGIoBcTvSjVyLJquE6-6Chk1dPFoLiXuQY/edit#gid=1865610127", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Kleisner",
             reference = "kleisner1",
             .after = "question_id")



################################################################################################################################
lau_png <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/18po7Pgq5Od6Q8yCnFdSfj_Gaxii34e-WsYwBFA3RTvo/edit#gid=1980661832", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Lau",
             reference = "lau1",
             .after = "question_id")



###############################################################################################################################
mason_iceland <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1ZPs5ow4wpZgj5eP26jvoMRgD9q6VT9DEdkJfqj7UrRE/edit#gid=2142384281", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Mason",
             reference = "mason1",
             .after = "question_id")




##########################################################################################################################
mills_lobster <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1HEPT54TsR1aTNNzDtZI59zU0eb-eJfH61ujErxAFtiI/edit#gid=553950990", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Mills",
             reference = "mills1",
             .after = "question_id")



########################################################################################################################
pecl_lobster <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/11Z-SLlAS0f9Ug1Z8gLMnHkaN7hoZT1W0KMVLG8HtbXs/edit#gid=179679195", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Pecl",
             reference = "pecl1",
             .after = "question_id")



###########################################################################################################################
#schmidt_senegal <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1bUY6yII5y0FZfDRJ5lxpA7iD2p3o__2A1xsWivxwKB0/edit#gid=2000123802", 
#                           sheet = "UPDATED_S4_ResilienceAttributes",
#                           range = "A6:P61",
#                           col_names = TRUE,
#                           na = "",
#                           guess_max = 10000,
#                           trim_ws = TRUE,
#                           col_types = "c"
#                           ) %>%
#  as_tibble() %>%
#  clean_names() %>% 
#  add_column(case_study = "Schmidt",
#             reference = "schmidt1",
#             .after = "question_id") 



###############################################################################################################################
tokunaga_lobster <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1jgFZut693B14rdKbxprKtQcoh-mFlMzAktekjhvwf2Q/edit#gid=228934601", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Tokunaga",
             reference = "tokunaga1",
             .after = "question_id") 



############################################################################################################################
westfall_hms <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1DMx0Ux9Li1LhIe4ee5bbAYtJaw1vCezziRGyeERBthY/edit#gid=1818956842", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Westfall",
             reference = "westfall1",
             .after = "question_id")



###################################################################################################################################
zhao_moorea <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1-Muz76--fNv1qfdXZcBENP-agemTTySZAay9uAEO0HI/edit#gid=1980661832", 
                           sheet = "UPDATED_S4_ResilienceAttributes",
                           range = "A6:P61",
                           col_names = TRUE,
                           na = "",
                           guess_max = 10000,
                           trim_ws = TRUE,
                           col_types = "c"
                           ) %>%
  as_tibble() %>%
  clean_names() %>% 
  add_column(case_study = "Zhao",
             reference = "zhao1",
             .after = "question_id")
```


##############################################################################################

# Merge the datasets

```{r}
attributes_merged <- rbind(aguion_barnacle, burden_sardine, dickey_collas_eur, eurich_clam, free_crab, friedman_fiji, golden_madagascar, hollowed_bering_sea, kisara_squid, kleisner_jfi, lau_png, mason_iceland, mills_lobster, pecl_lobster, tokunaga_lobster, westfall_hms, zhao_moorea)

```


# Clean the merged datasets 

```{r}
attributes_merged_clean <- attributes_merged %>% 
  rename(dimension=dimensions, 
         domain=new_domain, 
         attribute=resilience_attribute, 
         score=score_1_4,
         quality=information_quality, 
         importance=importance_of_attribute_in_study_system_high_medium_low, 
         work_as_described=does_the_mechanism_work_as_described_in_this_fishery_system) %>% 
# Simplify
  select(dimension, domain, case_study, reference, attribute, score, quality, importance, work_as_described) %>% 
# Remove spacer rows
  filter(!is.na(attribute)) %>% 
# Format scores
  filter(!is.na(score)) %>% 
# In order to get rid of "NA" values that were purposefully entered into the data, I used the `case_when` function to revert
  mutate(official_score = case_when(
    score == "1" ~ "1",
    score == "2" ~ "2",
    score == "3" ~ "3",
    score == "4" ~ "4",
    score == "NA" ~ "0"
  )) %>% 
  mutate(official_score=as.numeric(official_score)) %>%
  # Formate dimension
  mutate(dimension=recode_factor(dimension, 
                                 "Ecological"="Ecological",
                                 "Socio-economic"="Social-economic",
                                 "Governance-management"="Goverance")) %>% 
# Format data quality
  mutate(quality=ifelse(quality=="NA - Not relevant in this system", NA, quality),
         quality=recode_factor(quality,
                               "E - No data/information; no basis for expert judgement"="No data", ### CF used "E - No data/information; no basis for expert judgement", but JE's was different
                               "D - not confident that the answer provided reflects the true state of the system"="Low",
                               "C - fairly confident that the answer provided reflects the true state of the system"="Fair",
                               "B - limited data/information and expert judgement"="Good",
                               "A - adequate and reliable data/information"="Excellent")) %>% 
  # Format importance
  mutate(importance=stringr::str_to_sentence(importance),
         importance=factor(importance, levels=c("Low", "Medium", "High"))) %>% 
  # Create a new column to house numeric values for importance
  mutate(numeric_importance = case_when(
    importance == "Low" ~ "1",
    importance == "Medium" ~ "2",
    importance == "High" ~ "3")) %>% 
  mutate(numeric_importance=as.numeric(numeric_importance)) %>% 
  filter(!is.na(numeric_importance))
  
```



############################################################################################


# Plot the merged data by attribute of interest

```{r}
# Create theme
my_theme <-  theme(axis.text.x=element_text(size=8, angle=35, hjust=1),
                   axis.text.y=element_text(size=8),
                   axis.title=element_text(size=9),
                   legend.text=element_text(size=8),
                   legend.title=element_text(size=9),
                   strip.text=element_text(size=9),
                   plot.title=element_text(size=10),
                   # Gridlines
                   panel.grid.major = element_blank(), 
                   panel.grid.minor = element_blank(),
                   panel.background = element_rect(), 
                   axis.line = element_line())
```

The black dashed lines in the graphs below represent the mean scores of each attribute across the case studies.
The blue dashed line in the graphs below represent the mean importance scores where low = 1, medium = 2, and high = 3.

## Ecological

### Assets
#### Population Abundance
```{r}
# Filter the data to get the attribute you're looking for
population_abundance <- attributes_merged_clean %>% 
  filter(attribute == "Population abundance") 


ggplot() +
  geom_bar(data=population_abundance, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Population Abundance Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  geom_hline(data=population_abundance, aes(yintercept = mean(official_score)), linetype="dashed") +
  theme_bw() + my_theme  
```

#### Age Structure

```{r}
age_structure <- attributes_merged_clean %>% 
  filter(attribute == "Age structure") 


ggplot() +
  geom_bar(data=age_structure, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Age Structure Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=age_structure, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Genetic Diversity

```{r}
genetic_diversity <- attributes_merged_clean %>% 
  filter(attribute == "Genetic diversity") 


ggplot() +
  geom_bar(data=genetic_diversity, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Genetic Diversity Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=genetic_diversity, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Species Diversity

```{r}
species_diversity <- attributes_merged_clean %>% 
  filter(attribute == "Species diversity") 


ggplot() +
  geom_bar(data=species_diversity, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Species Diversity Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=species_diversity, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


### Flexibility
#### Adult Mobility

```{r}
adult_mobility <- attributes_merged_clean %>% 
  filter(attribute == "Adult mobility") 


ggplot() +
  geom_bar(data=adult_mobility, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Adult Mobility Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=adult_mobility, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Larval Dispersal

```{r}
larval_dispersal <- attributes_merged_clean %>% 
  filter(attribute == "Larval dispersal") 


ggplot() +
  geom_bar(data=larval_dispersal, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Larval Dispersal Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  # Had to delete the first blue color in the code below in order to match the colors appropriately since there are no "low" importance valuus for this attribute
  scale_fill_manual(values = c("#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=larval_dispersal, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Environmental Niche Breadth

```{r}
environmental_breadth <- attributes_merged_clean %>% 
  filter(attribute == "Environmental niche breadth") 


ggplot() +
  geom_bar(data=environmental_breadth, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Environmental Niche Breadth Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=environmental_breadth, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Dietary Flexibility

```{r}
dietary_flexibility <- attributes_merged_clean %>% 
  filter(attribute == "Dietary flexibility") 


ggplot() +
  geom_bar(data=dietary_flexibility, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Dietary Flexibility Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=dietary_flexibility, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Habitat Diversity

```{r}
habitat_diversity <- attributes_merged_clean %>% 
  filter(attribute == "Habitat diversity") 


ggplot() +
  geom_bar(data=habitat_diversity, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Habitat Diversity Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=habitat_diversity, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Plasticity

```{r}
plasticity <- attributes_merged_clean %>% 
  filter(attribute == "Plasticity") 


ggplot() +
  geom_bar(data=plasticity, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Plasticity Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=plasticity, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Evolutionary Potential

```{r}
evolutionary_potential <- attributes_merged_clean %>% 
  filter(attribute == "Evolutionary potential") 


ggplot() +
  geom_bar(data=evolutionary_potential, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Evolutionary Potential Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=evolutionary_potential, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


### Organization
#### Ecosystem Connectivity

```{r}
ecosystem_connectivity <- attributes_merged_clean %>% 
  filter(attribute == "Ecosystem connectivity") 


ggplot() +
  geom_bar(data=ecosystem_connectivity, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Ecosystem Connectivity Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=ecosystem_connectivity, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Population Modularity

```{r}
population_modularity <- attributes_merged_clean %>% 
  filter(attribute == "Population modularity") 


ggplot() +
  geom_bar(data=population_modularity, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Population Modularity Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=population_modularity, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


## Socio-economic

### Assets
#### Wealth and Reserves

```{r}
wealth_reserves <- attributes_merged_clean %>% 
  filter(attribute == "Wealth and reserves") 


ggplot() +
  geom_bar(data=wealth_reserves, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Wealth and Reserves Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=wealth_reserves, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Economic Diversity

```{r}
economic_divserity <- attributes_merged_clean %>% 
  filter(attribute == "Economic diversity") 


ggplot() +
  geom_bar(data=economic_divserity, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Ecosystem Connectivity Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=economic_divserity, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Social Diversity

```{r}
social_divsersity <- attributes_merged_clean %>% 
  filter(attribute == "Social diversity") 


ggplot() +
  geom_bar(data=social_divsersity, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Social Diversity Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=social_divsersity, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


### Flexibility
#### Flexible and Agile Infrstructure

```{r}
flexible_agile <- attributes_merged_clean %>% 
  filter(attribute == "Flexible and agile infrstructure") # "infrastructure" was spelled wrong in the google sheets


ggplot() +
  geom_bar(data=flexible_agile, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Flexible and Agile Infrastructure Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=flexible_agile, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=flexible_agile, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Mobility

```{r}
mobility <- attributes_merged_clean %>% 
  filter(attribute == "Mobility") 


ggplot() +
  geom_bar(data=mobility, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Mobility Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=mobility, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Economic Opportunity

```{r}
economic_opportunity <- attributes_merged_clean %>% 
  filter(attribute == "Economic opportunity") 


ggplot() +
  geom_bar(data=economic_opportunity, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Economic Opportuntity Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07")) +
  geom_hline(data=economic_opportunity, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Resilience Mindset

```{r}
resilience_mindset <- attributes_merged_clean %>% 
  filter(attribute == "Resilience mindset") 


ggplot() +
  geom_bar(data=resilience_mindset, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "REsilience mindset Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=resilience_mindset, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=resilience_mindset, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Place Attachment

```{r}
place_attachment <- attributes_merged_clean %>% 
  filter(attribute == "Place attachment") 


ggplot() +
  geom_bar(data=place_attachment, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Place Attachment Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=place_attachment, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


### Orgaanization
#### Social Capital

```{r}
social_capital <- attributes_merged_clean %>% 
  filter(attribute == "Social capital") 


ggplot() +
  geom_bar(data=social_capital, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Social Capital Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=social_capital, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Technology Transfer

```{r}
tech_transfer <- attributes_merged_clean %>% 
  filter(attribute == "Technology transfer") 


ggplot() +
  geom_bar(data=tech_transfer, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Technology Transfer Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=tech_transfer, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Modular Infrastructure

```{r}
modular_infrastrucutre <- attributes_merged_clean %>% 
  filter(attribute == "Modular infrastructure") 


ggplot() +
  geom_bar(data=modular_infrastrucutre, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Modular Infrastructure Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=modular_infrastrucutre, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


### Learning
#### Knowledge Divserity

```{r}
knowledge_diversity <- attributes_merged_clean %>% 
  filter(attribute == "Knowledge diversity") 


ggplot() +
  geom_bar(data=knowledge_diversity, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Knowledge Diversity Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=knowledge_diversity, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Knowledge Access

```{r}
knowledge_access <- attributes_merged_clean %>% 
  filter(attribute == "Knowledge access") 


ggplot() +
  geom_bar(data=knowledge_access, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "KNowledge Access Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=knowledge_access, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Learning Capacity

```{r}
learning_capacity <- attributes_merged_clean %>% 
  filter(attribute == "Learning capacity") 


ggplot() +
  geom_bar(data=learning_capacity, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Learning capacity Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=learning_capacity, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


### Agency
#### Agency

```{r}
agency <- attributes_merged_clean %>% 
  filter(attribute == "Agency") 


ggplot() +
  geom_bar(data=agency, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Agency Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=agency, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


## Governance

### Flexibility
#### Responsive

```{r}
responsive <- attributes_merged_clean %>% 
  filter(attribute == "Responsive") 


ggplot() +
  geom_bar(data=responsive, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Responsive Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=responsive, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


### Organization
#### Participaory

```{r}
participatory <- attributes_merged_clean %>% 
  filter(attribute == "Participatory") 


ggplot() +
  geom_bar(data=participatory, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Participatory Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=participatory, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Equitbale and Inclusive

```{r}
equitable_inclusive <- attributes_merged_clean %>% 
  filter(attribute == "Equitable and inclusive") 


ggplot() +
  geom_bar(data=equitable_inclusive, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Equitable and Inclusive Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=equitable_inclusive, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```

#### Accountable

```{r}
accountable <- attributes_merged_clean %>% 
  filter(attribute == "Accountable") 


ggplot() +
  geom_bar(data=accountable, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Accountable Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=accountable, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Transparent

```{r}
transparent <- attributes_merged_clean %>% 
  filter(attribute == "Transparent") 


ggplot() +
  geom_bar(data=transparent, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Transparent Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=transparent, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Effective and Efficient

```{r}
effective_efficient <- attributes_merged_clean %>% 
  filter(attribute == "Effective and efficient") 


ggplot() +
  geom_bar(data=effective_efficient, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Effective and Efficient Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=effective_efficient, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Polycentric

```{r}
polycentric <- attributes_merged_clean %>% 
  filter(attribute == "Polycentric") 


ggplot() +
  geom_bar(data=polycentric, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Polycentric Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=polycentric, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


#### Cross-scale Integration

```{r}
cross_scale <- attributes_merged_clean %>% 
  filter(attribute == "Cross-scale integration") 


ggplot() +
  geom_bar(data=cross_scale, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Cross-scale Integration Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=cross_scale, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


### Learning
#### Adaptive

```{r}
adaptive <- attributes_merged_clean %>% 
  filter(attribute == "Adaptive") 


ggplot() +
  geom_bar(data=adaptive, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Adaptive Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=adaptive, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```


### Agency
#### Leadership and Initiative

```{r}
leadership_initiative <- attributes_merged_clean %>% 
  filter(attribute == "Leadership and initiative") 


ggplot() +
  geom_bar(data=leadership_initiative, stat='identity', mapping=aes(y=official_score, yend=official_score, x=case_study, xend=case_study, fill=importance, alpha=quality)) +
  scale_y_continuous( breaks=1:4, labels=c("1\n(none)", "2\n(low)", "3\n(medium)", "4\n(high)")) +
  labs(title = "Leadership and Initiative Scores Across Case Studies", x = "Case Studies", y = "Attribute Score", fill = "Importance") + 
  scale_alpha_ordinal(name="Data quality") + 
  guides(fill = guide_legend(order = 1), alpha = guide_legend(order = 2)) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800", "#FC4E07", "#999999")) +
  geom_hline(data=leadership_initiative, aes(yintercept = mean(official_score)), linetype="dashed") +
  geom_hline(data=population_abundance, aes(yintercept = mean(numeric_importance)), linetype="dashed", colour="blue") +
  theme_bw() + my_theme
```



















